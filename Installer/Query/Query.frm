ackColor       =   &H00949C94&
      Height          =   315
      ItemData        =   "Query.frx":60DA
      Left            =   2760
      List            =   "Query.frx":6174
      TabIndex        =   31
      Text            =   "20 Sec"
      Top             =   6360
      Width           =   1095
   End
   Begin MSComctlLib.ImageList imgLstSpy 
      Left            =   4200
      Top             =   6480
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   19
      ImageHeight     =   20
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   7
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":632A
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":6463
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":66F8
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":6985
            Key             =   ""
            Object.Tag             =   "Muhammad Naeem"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":74B9
            Key             =   ""
            Object.Tag             =   "Tauseef Jamal"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":81CE
            Key             =   ""
            Object.Tag             =   "Tauseef Jamal"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":9217
            Key             =   ""
            Object.Tag             =   "Muhammad Naeem"
         EndProperty
      EndProperty
   End
   Begin VB.TextBox txtDisplay 
      BackColor       =   &H00949C94&
      BorderStyle     =   0  'None
      ForeColor       =   &H000000FF&
      Height          =   350
      Left            =   1080
      Locked          =   -1  'True
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   28
      Top             =   660
      Width           =   5920
   End
   Begin VB.ComboBox cboY2 
      BackColor       =   &H00949C94&
      Height          =   315
      ItemData        =   "Query.frx":9AFA
      Left            =   6840
      List            =   "Query.frx":A3FB
      TabIndex        =   22
      Text            =   "300"
      Top             =   6360
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.ComboBox cboX2 
      BackColor       =   &H00949C94&
      Height          =   315
      ItemData        =   "Query.frx":B28E
      Left            =   5400
      List            =   "Query.frx":BE8F
      TabIndex        =   21
      Text            =   "400"
      Top             =   6360
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.ComboBox cboY1 
      BackColor       =   &H00949C94&
      Height          =   315
      ItemData        =   "Query.frx":D23A
      Left            =   6840
      List            =   "Query.frx":DB3B
      TabIndex        =   20
      Text            =   "1"
      Top             =   6000
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.ComboBox cboX1 
      BackColor       =   &H00949C94&
      Height          =   315
      ItemData        =   "Query.frx":E9CE
      Left            =   5400
      List            =   "Query.frx":F5CF
      TabIndex        =   19
      Text            =   "1"
      Top             =   6000
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.ComboBox cboShutDownMode 
      BackColor       =   &H00949C94&
      BeginProperty Font 
         Name            =   "SimSun"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      ItemData        =   "Query.frx":1097A
      Left            =   2760
      List            =   "Query.frx":10990
      TabIndex        =   18
      Text            =   "Log Off"
      Top             =   1080
      Width           =   1095
   End
   Begin MSComctlLib.ImageList ImgList 
      Index           =   0
      Left            =   4800
      Top             =   3120
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   13
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":109D7
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":10ACE
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":10C42
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":10E95
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":10F6E
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":11065
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":115FF
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":11731
            Key             =   ""
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":117BA
            Key             =   ""
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":11934
            Key             =   ""
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":11A00
            Key             =   ""
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":122DA
            Key             =   ""
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":1237C
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin VB.TextBox txtSendKeys 
      BackColor       =   &H00949C94&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Left            =   3960
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   13
      Top             =   5160
      Width           =   3735
   End
   Begin VB.TextBox txtRunApp 
      BackColor       =   &H00949C94&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Left            =   3960
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   12
      Top             =   2280
      Width           =   3735
   End
   Begin VB.ListBox lstKeys 
      BackColor       =   &H00949C94&
      Height          =   4350
      ItemData        =   "Query.frx":127CA
      Left            =   2760
      List            =   "Query.frx":12843
      TabIndex        =   11
      Top             =   1920
      Width           =   1095
   End
   Begin VB.OptionButton optLocalTest 
      BackColor       =   &H00949C94&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00808000&
      Height          =   255
      Index           =   1
      Left            =   3960
      TabIndex        =   10
      Top             =   4200
      Width           =   255
   End
   Begin VB.OptionButton optLocalTest 
      BackColor       =   &H00949C94&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   255
      Index           =   0
      Left            =   3960
      TabIndex        =   9
      Top             =   3960
      Value           =   -1  'True
      Width           =   255
   End
   Begin VB.ComboBox cboTime 
      BackColor       =   &H00949C94&
      Height          =   315
      ItemData        =   "Query.frx":1296D
      Left            =   2760
      List            =   "Query.frx":12998
      TabIndex        =   6
      Text            =   "3 Sec"
      Top             =   1560
      Width           =   1095
   End
   Begin VB.ComboBox cboClientIP 
      BackColor       =   &H00949C94&
      BeginProperty Font 
         Name            =   "SimSun"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      ItemData        =   "Query.frx":129FD
      Left            =   5640
      List            =   "Query.frx":12A13
      TabIndex        =   2
      Text            =   "10.49.1.4"
      Top             =   1560
      Width           =   1335
   End
   Begin VB.ComboBox cboRemoteIP 
      BackColor       =   &H00949C94&
      BeginProperty Font 
         Name            =   "SimSun"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      ItemData        =   "Query.frx":12A5A
      Left            =   5640
      List            =   "Query.frx":12B06
      TabIndex        =   1
      Text            =   "10.49.0.5"
      Top             =   1080
      Width           =   1335
   End
   Begin VB.Timer tmrScan 
      Enabled         =   0   'False
      Interval        =   2000
      Left            =   6480
      Top             =   3240
   End
   Begin VB.ListBox lstSpyData 
      BackColor       =   &H00949C94&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   4350
      Left            =   360
      TabIndex        =   0
      Top             =   1920
      Width           =   2295
   End
   Begin MSComDlg.CommonDialog cdlApplication 
      Left            =   7080
      Top             =   3240
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin MSComctlLib.ImageList ImgList 
      Index           =   1
      Left            =   5520
      Top             =   3120
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   13
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":12D9C
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":12E93
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13017
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13286
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13375
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13472
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13A0C
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13B48
            Key             =   ""
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13BD4
            Key             =   ""
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13D80
            Key             =   ""
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":13E4C
            Key             =   ""
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":14726
            Key             =   ""
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Query.frx":147C8
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin VB.Image imgMouse 
      Height          =   480
      Left            =   6600
      ToolTipText     =   "Capture Mouse"
      Top             =   7200
      Width           =   480
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Duration:-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   255
      Index           =   11
      Left            =   1440
      TabIndex        =   30
      Top             =   6360
      Width           =   975
   End
   Begin VB.Image imgExit 
      Height          =   495
      Left            =   7440
      ToolTipText     =   "Exit Net Eye"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgAbout 
      Height          =   495
      Left            =   5760
      ToolTipText     =   "About Net Eye"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgClearData 
      Height          =   495
      Left            =   240
      ToolTipText     =   "Clear Serialized Data"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgMessenger 
      Height          =   495
      Left            =   5040
      ToolTipText     =   "Invoke MessageBox ? ! X"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgShutDown 
      Height          =   495
      Left            =   4320
      ToolTipText     =   "Shut-Down , Log-off, Reboot"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgDesktopScan 
      Height          =   495
      Left            =   2880
      ToolTipText     =   "Scan Desktop Image"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgScan 
      Height          =   495
      Left            =   1680
      ToolTipText     =   "Start Scanning"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgRender 
      Height          =   495
      Left            =   3600
      ToolTipText     =   "View Scanned Image / Hide Net Eye"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Label lblScannedTime 
      BackStyle       =   0  'Transparent
      Caption         =   "Scanned Time:-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   495
      Left            =   5040
      TabIndex        =   29
      Top             =   6720
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Image imgScanKeys 
      Height          =   495
      Left            =   960
      ToolTipText     =   "Start KeyLogger"
      Top             =   7200
      Width           =   495
   End
   Begin VB.Image imgLocalTest 
      Height          =   495
      Left            =   6480
      ToolTipText     =   "Local Test"
      Top             =   3960
      Width           =   495
   End
   Begin VB.Image imgStatus 
      Height          =   255
      Left            =   7800
      ToolTipText     =   "Connectivity Status"
      Top             =   7800
      Width           =   255
   End
   Begin VB.Label lblTime 
      BackColor       =   &H00949C94&
      ForeColor       =   &H00FF0000&
      Height          =   375
      Left            =   6000
      TabIndex        =   27
      Top             =   6720
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.Label lblY2 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Y2="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   195
      Left            =   6480
      TabIndex        =   26
      Top             =   6480
      Visible         =   0   'False
      Width           =   345
   End
   Begin VB.Label lblY1 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Y1="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   195
      Left            =   6480
      TabIndex        =   25
      Top             =   6120
      Visible         =   0   'False
      Width           =   345
   End
   Begin VB.Label lblX2 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "X2="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   195
      Left            =   5040
      TabIndex        =   24
      Top             =   6480
      Visible         =   0   'False
      Width           =   345
   End
   Begin VB.Label lblX1 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "X1="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   195
      Left            =   5040
      TabIndex        =   23
      Top             =   6120
      Visible         =   0   'False
      Width           =   345
   End
   Begin VB.Image imgInvokeKeys 
      Height          =   495
      Left            =   3720
      ToolTipText     =   "Invoke Keys at Remote System"
      Top             =   5880
      Width           =   495
   End
   Begin VB.Image imgInvokeApp 
      Height          =   495
      Left            =   3960
      ToolTipText     =   "Invoke Application"
      Top             =   3120
      Width           =   495
   End
   Begin VB.Label lblLocalTest 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Local Key Stroke Test"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00008000&
      Height          =   195
      Index           =   1
      Left            =   4320
      TabIndex        =   17
      Top             =   4200
      Width           =   1995
   End
   Begin VB.Label lblLocalTest 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Local Application Test"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00008000&
      Height          =   195
      Index           =   0
      Left            =   4320
      TabIndex        =   16
      Top             =   3960
      Width           =   2010
   End
   Begin VB.Label Label1 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Insert you Key Strokes:-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00008000&
      Height          =   195
      Index           =   2
      Left            =   3960
      TabIndex        =   15
      Top             =   4920
      Width           =   2055
   End
   Begin VB.Label Label1 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Insert Application Name:-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00008000&
      Height          =   195
      Index           =   3
      Left            =   3960
      TabIndex        =   14
      Top             =   2040
      Width           =   2160
   End
   Begin VB.Label Label1 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Scan Interval:-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   195
      Index           =   1
      Left            =   1080
      TabIndex        =   8
      Top             =   1560
      Width           =   1275
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Spy Count:- "
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   255
      Index           =   0
      Left            =   1080
      TabIndex        =   7
      Top             =   1200
      Width           =   1095
   End
   Begin VB.Label lblCounter 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   240
      Left            =   2280
      TabIndex        =   5
      Top             =   1200
      Width           =   105
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Cleint Machine:-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   255
      Index           =   7
      Left            =   4080
      TabIndex        =   4
      Top             =   1560
      Width           =   1455
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Remote Machine:-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   255
      Index           =   6
      Left            =   4080
      TabIndex        =   3
      Top             =   1080
      Width           =   1575
   End
   Begin VB.Menu mnuFile 
      Caption         =   "File"
      Visible         =   0   'False
      Begin VB.Menu mnuShow 
         Caption         =   "Show"
      End
      Begin VB.Menu mnuSep 
         Caption         =   "-"
      End
      Begin VB.Menu mnuAbout 
         Caption         =   "About"
      End
      Begin VB.Menu mnuExit 
         Caption         =   "Exit"
      End
   End
End
Attribute VB_Name = "Query"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Public lngCounter As Long, bolAlreadyActive As Boolean
Dim flgIcon As Boolean
Const DimensionCounter As Integer = 7000
Dim oldX As Integer, oldY As Integer, MoveMe As Boolean
Dim mousePT As POINTAPI


    '/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\'
    '                                                            '
    '      Net Eye                                               '
    '      Software®                                             '
    '                                                            '
    '                                                            '
    '        Licensed Product                                    '
    '        Copyright © 2002-2003                               '
    '        Net Eye V1.0                                        '
    '        Author:- Muhammad Naeem   (naeem@email.com)         '
    '                 Tauseef Jamal    (gr8_libran@yahoo.com)    '
    '                                                            '
    '/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\'

Private Function MakeTrip()
On Error GoTo EH
 Dim objSpyCaller As Object
 Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
  objSpyCaller.ScanScreen (cboClientIP.Text)
  MakeTrip = "Success"
 Exit Function
EH:
 MakeTrip = Err.Number & Space(2) & Err.Description & vbCrLf & "Query.MakeTrip()"
End Function

Private Sub cboClientIP_KeyPress(KeyAscii As Integer)
  If (KeyAscii < 48 Or KeyAscii > 57) And KeyAscii <> 8 And KeyAscii <> 46 Then KeyAscii = 0
End Sub


Private Sub cboDuration_KeyPress(KeyAscii As Integer)
  KeyAscii = 0
End Sub

Private Sub cboRemoteIP_KeyPress(KeyAscii As Integer)
  If (KeyAscii < 48 Or KeyAscii > 57) And KeyAscii <> 8 And KeyAscii <> 46 Then KeyAscii = 0
End Sub

Private Sub cboShutDownMode_KeyPress(KeyAscii As Integer)
 KeyAscii = 0
End Sub

Private Sub cboTime_Click()
  'tmrScan.Interval = (Val(cboTime.Text) - 2) * 1000
  tmrScan.Interval = Val(cboTime.Text) * 1000
End Sub

Private Sub cboTime_KeyPress(KeyAscii As Integer)
 KeyAscii = 0
End Sub

Private Sub cboX1_KeyPress(KeyAscii As Integer)
 'If (KeyAscii < 48 Or KeyAscii > 57) And KeyAscii <> 8 Then KeyAscii = 0
 KeyAscii = 0
End Sub

Private Sub cboX2_KeyPress(KeyAscii As Integer)
  'If (KeyAscii < 48 Or KeyAscii > 57) And KeyAscii <> 8 Then KeyAscii = 0
  KeyAscii = 0
End Sub

Private Sub cboY1_KeyPress(KeyAscii As Integer)
 'If (KeyAscii < 48 Or KeyAscii > 57) And KeyAscii <> 8 Then KeyAscii = 0
 KeyAscii = 0
End Sub

Private Sub cboY2_KeyPress(KeyAscii As Integer)
 'If (KeyAscii < 48 Or KeyAscii > 57) And KeyAscii <> 8 Then KeyAscii = 0
 KeyAscii = 0
End Sub

Public Sub FastCapture(Button As Integer)
 Dim strFile As String
 Dim strError As String
 Dim B() As Byte
 
 On Error GoTo EH
 Dim objSpyCaller As Object
 Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
 imgDesktopScan.Visible = False
 
Select Case Button
Case vbLeftButton:
  txtDisplay.Text = objSpyCaller.TakeSnapShot
  
Case vbRightButton:
 strFile = App.Path & "\WinMap.bmp"
 B = objSpyCaller.PickSnapShotData(strError)
 Open strFile For Binary Access Write As #2
   Put #2, , B
 Close #2
 DoEvents
 txtDisplay.Text = strError
 End Select
 
 DoEvents
 imgDesktopScan.Visible = True
 
 Exit Sub
EH:
 txtDisplay.Text = Err.Description & vbCrLf & Err.Number & vbCrLf & "Query.FastCapture"
 imgDesktopScan.Visible = True
End Sub

Private Sub chkSnapShot_Click()
 
lblX1.Visible = Not lblX1.Visible:   lblY1.Visible = Not lblY1.Visible
lblX2.Visible = Not lblX2.Visible: lblY2.Visible = Not lblY2.Visible:
   
cboX1.Visible = Not cboX1.Visible:   cboY1.Visible = Not cboY1.Visible
cboX2.Visible = Not cboX2.Visible: cboY2.Visible = Not cboY2.Visible:

lblScannedTime.Visible = Not lblScannedTime.Visible
lblTime.Visible = Not lblTime.Visible
 
End Sub



Private Sub Form_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    MoveMe = True:    oldX = X:    oldY = Y
End Sub

Private Sub Form_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Me.Left = Me.Left + (X - oldX):    Me.Top = Me.Top + (Y - oldY)
    MoveMe = False
End Sub


Private Sub imgClearData_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  Select Case Button
  Case vbLeftButton
     txtDisplay.Text = EmptyFile("Data.spy")
  Case vbRightButton
     txtDisplay.Text = EmptyFile("WinsKBoard.spy")
  End Select
End Sub

Private Sub imgDesktopScan_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
 
 If chkSnapShot.Value = Checked Then FastCapture Button: Exit Sub
   
 If Button = vbLeftButton Then
        CaptureDesktop
 ElseIf Button = vbRightButton Then
   PickPixelData
 End If
End Sub

Private Sub CaptureDesktop()
On Error GoTo EH
 
 Dim objSpyCaller As Object
 Dim dblTimer As Double
 Dim Coords(4) As Integer
 
 dblTimer = Timer
 Screen.MousePointer = vbHourglass
 lblTime.Caption = vbNullString
 
 txtDisplay.Text = "Wait.............. It may take 0.5 to 03 Minutes..."
 imgDesktopScan.Visible = False
   
 Coords(0) = CInt(cboX1):   Coords(1) = CInt(cboY1)
 Coords(2) = CInt(cboX2):   Coords(3) = CInt(cboY2)
 
 Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
 txtDisplay.Text = objSpyCaller.ScanDesktop(cboClientIP.Text, Coords)
 imgDesktopScan.Visible = True
  
 lblTime.Caption = Timer - dblTimer & "  Seconds"
 Screen.MousePointer = vbNormal
 Exit Sub
EH:
 txtDisplay.Text = Err.Number & Space(1) & Err.Description & vbCrLf & "CaptureDesktiop()"
 lblTime.Caption = vbNullString
 imgDesktopScan.Visible = True
 Screen.MousePointer = vbNormal

End Sub

Private Sub PickPixelData()
On Error GoTo EH
 Dim objSpyCaller As Object
 Dim dblTimer As Double, strFlag As String
 Dim objF As New FileSystemObject, objT As TextStream
 Dim B() As Byte
 
 dblTimer = Timer
 Screen.MousePointer = vbHourglass
 lblTime.Caption = vbNullString
 
 txtDisplay.Text = "Wait.............. It may take 0.5 to 03 Minutes..."
 imgDesktopScan.Visible = False
  
 Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
 B = objSpyCaller.PickPixelData(strFlag)
 Open App.Path & "\Map.spy" For Binary Access Write As #2
    Put #2, , B
 Close #2
  
  txtDisplay.Text = strFlag
  imgDesktopScan.Visible = True
  
 lblTime.Caption = Timer - dblTimer & "  Seconds"
 Screen.MousePointer = vbNormal
 Exit Sub
EH:
 txtDisplay.Text = Err.Number & Space(1) & Err.Description & vbCrLf & "PickPixelData()"
 lblTime.Caption = vbNullString
 imgDesktopScan.Visible = True
 Screen.MousePointer = vbNormal

End Sub

Private Sub InvokeApplication()
On Error GoTo EH
 If Trim(txtRunApp.Text) = vbNullString Then
   txtDisplay.Text = "Write the name of some application (e.g. 'notepad.exe')"
   txtRunApp.SetFocus
   Exit Sub
 End If
 
 imgInvokeApp.Enabled = False
 Dim objSpyCaller As Object
 Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
  txtDisplay.Text = objSpyCaller.InvokeApp(txtRunApp.Text)
 imgInvokeApp.Enabled = True
 Exit Sub
EH:
 txtDisplay.Text = Err.Number & Space(1) & Err.Description & vbCrLf & "Query.imgInvokeApp_Click()"
  imgInvokeApp.Enabled = True
End Sub

Private Sub imgInvokeApp_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgInvokeApp.Picture = ImgList(1).ListImages(1).Picture
 flgIcon = True
End Sub

Private Sub imgInvokeApp_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
 If Button = vbLeftButton Then
   InvokeApplication
 ElseIf Button = vbRightButton Then
   cdlApplication.ShowOpen
   txtRunApp.Text = cdlApplication.FileName
 End If
End Sub

Private Sub imgInvokeKeys_Click()
On Error GoTo EH
 If Trim(txtSendKeys.Text) = vbNullString Then
   txtDisplay.Text = "Write some key or select from the List Box by double clicking"
   txtSendKeys.SetFocus
 Exit Sub
 End If
 
 imgInvokeKeys.Enabled = False
 Dim objSpyCaller As Object
 Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
  txtDisplay.Text = objSpyCaller.InvokeKeys(txtSendKeys.Text)
 imgInvokeKeys.Enabled = True
 Exit Sub
EH:
 txtDisplay.Text = Err.Number & Space(1) & Err.Description & vbCrLf & "Query.imgInvokeKeys_Click()"
  imgInvokeKeys.Enabled = True

End Sub

Private Sub imgInvokeKeys_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgInvokeKeys.Picture = ImgList(1).ListImages(3).Picture
 flgIcon = True
End Sub

Private Sub imgLocalTest_Click()
 On Error GoTo EH:
 
 If optLocalTest(0).Value = True Then  '  if application checking is required
  If Trim(txtRunApp.Text) = vbNullString Then Exit Sub
  Shell txtRunApp.Text, vbNormalFocus
 Else
  If Trim(txtSendKeys.Text) = vbNullString Then Exit Sub
  SendKeys txtSendKeys, True
 End If
 Exit Sub
EH:
 txtDisplay.Text = Err.Number & Space(1) & Err.Description & vbCrLf & "Query.imgLocalTest_Click()"
End Sub

Private Sub Form1_Activate()
 If bolAlreadyActive = True Then Exit Sub
  
 Me.Width = 1: Me.Height = 1
 Dim intCounter As Integer
 For intCounter = 1 To DimensionCounter
   'If Me.Height <> DimensionCounter Then Me.Height = Me.Height + 1
   Me.Height = Me.Height + 1
   Me.Width = Me.Width + 1
   Me.WindowState = 0
 Next
 bolAlreadyActive = True
End Sub

Private Sub Form_Load()
 '' set the status of the icon as grey
 imgStatus.Picture = imgLstSpy.ListImages(1).Picture
 Icon_Off
End Sub

Private Sub Icon_Off()
 imgInvokeApp.Picture = ImgList(0).ListImages(1).Picture
 imgLocalTest.Picture = ImgList(0).ListImages(2).Picture
 imgInvokeKeys.Picture = ImgList(0).ListImages(3).Picture
 imgClearData.Picture = ImgList(0).ListImages(4).Picture
 imgScanKeys.Picture = ImgList(0).ListImages(5).Picture
 imgScan.Picture = ImgList(0).ListImages(6).Picture
 imgDesktopScan.Picture = ImgList(0).ListImages(7).Picture
 imgRender.Picture = ImgList(0).ListImages(8).Picture
 imgShutDown.Picture = ImgList(0).ListImages(9).Picture
 imgMessenger.Picture = ImgList(0).ListImages(10).Picture
 imgAbout.Picture = ImgList(0).ListImages(11).Picture
 imgMouse.Picture = ImgList(0).ListImages(12).Picture
 imgExit.Picture = ImgList(0).ListImages(13).Picture
 flgIcon = False
End Sub


Private Sub Form_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 If MoveMe = True Then
        Me.Left = Me.Left + (X - oldX)
        Me.Top = Me.Top + (Y - oldY)
 End If
    
 If flgIcon = False Then Exit Sub
 Icon_Off
 
End Sub

Private Sub Form_Unload(Cancel As Integer)
 Dim intCounter As Integer, F As Object
 For intCounter = 1 To DimensionCounter
   Me.WindowState = 0
   Me.Width = Me.Width - 1
   Me.Height = Me.Height - 1
 Next
 End
End Sub

Private Sub imgAbout_Click()
 frmAbout.Show vbModal
End Sub

Private Sub imgAbout_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgAbout.Picture = ImgList(1).ListImages(11).Picture
 flgIcon = True
End Sub

Private Sub imgMessenger_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgMessenger.Picture = ImgList(1).ListImages(10).Picture
 flgIcon = True
End Sub


Private Sub imgClearData_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgClearData.Picture = ImgList(1).ListImages(4).Picture
 flgIcon = True
End Sub

Private Sub imgDesktopScan_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgDesktopScan.Picture = ImgList(1).ListImages(7).Picture
 flgIcon = True
End Sub

Private Sub imgExit_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgExit.Picture = ImgList(1).ListImages(13).Picture
 flgIcon = True
End Sub

Private Sub imgExit_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
 If Button = vbLeftButton Then
   Unload Me
 Else
   End
 End If
End Sub

Private Sub imgLocalTest_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgLocalTest.Picture = ImgList(1).ListImages(2).Picture
 flgIcon = True
End Sub

Private Sub imgMessenger_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
 On Error GoTo EH
 Dim strMessage As String
 Dim objSpyCaller As Object
 
 Select Case Button
 Case vbRightButton
   frmMessage.Show 1, Query: Exit Sub
 Case vbLeftButton
  If Trim(txtRunApp.Text) = vbNullString Then txtRunApp.SetFocus: txtDisplay.Text = "Some message is required ": Exit Sub
  
  strMessage = "net send " & cboRemoteIP.Text & Space(1) & Trim(txtRunApp.Text)
  Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
  txtDisplay.Text = objSpyCaller.InvokeApp(strMessage):   Exit Sub
 End Select
 
EH:
 txtDisplay.Text = Err.Description & vbCrLf & Err.Number

End Sub


Private Sub imgMouse_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgMouse.Picture = ImgList(1).ListImages(12).Picture
 flgIcon = True
End Sub

Private Sub imgMouse_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
 On Error GoTo EH
  Dim objCaller As Object
  Static bSwap As Boolean
  If cboRemoteIP = cboClientIP Then txtDisplay = "Don't test it Locally": Exit Sub
 Select Case Button
 Case vbLeftButton:
  tmrCaptureMouse.Enabled = Not tmrCaptureMouse.Enabled
  If tmrCaptureMouse.Enabled = True Then
    imgMouse.ToolTipText = "Stop"
  Else
    imgMouse.ToolTipText = "Start"
  End If
  
 Case vbRightButton
   bSwap = Not bSwap
   Set objCaller = CreateObject("NetEye.Caller", cboRemoteIP)
   txtDisplay = objCaller.SwapMouseButtons(bSwap)
 End Select
 
 Exit Sub
EH:
 txtDisplay = Err.Number & Space(2) & Err.Description
End Sub


Private Sub imgrender_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgRender.Picture = ImgList(1).ListImages(8).Picture
 flgIcon = True
End Sub

Private Sub imgRender_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
 Select Case Button
 Case vbLeftButton:    frmDesktop.Show
 Case vbRightButton: Create_Tray
 
 End Select
End Sub

Private Sub imgScan_Click()
  On Error GoTo EH
  
  If CheckConnection <= 0 And imgScan.ToolTipText = "Start Scanning" Then
     DoEvents
     txtDisplay.Text = "Remote Machine is not Responding! " & vbCrLf & " It is looking to be unavailable..."
     imgStatus.Picture = imgLstSpy.ListImages(3).Picture
     Exit Sub
  End If
 
 tmrScan.Enabled = Not tmrScan.Enabled
 
 If imgScan.ToolTipText = "Stop Scanning" Then
  imgScan.ToolTipText = "Start Scanning"
  txtDisplay.Text = "NetEye Scan is Stop..........."
  imgStatus.Picture = imgLstSpy.ListImages(1).Picture
 Else
  imgScan.ToolTipText = "Stop Scanning"
  txtDisplay.Text = "NetEye Scan is Running..........."
 End If
 
 Exit Sub
EH:
 txtDisplay = Err.Number & Space(2) & Err.Description
End Sub

Private Sub imgScan_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgScan.Picture = ImgList(1).ListImages(6).Picture
 flgIcon = True
End Sub



Private Sub imgScanKeys_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgScanKeys.Picture = ImgList(1).ListImages(5).Picture
 flgIcon = True
End Sub

Private Sub imgScanKeys_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
 Dim objSpyCaller As Object
 Dim strFlag As String
 Dim objFile As New FileSystemObject
 Dim objText As TextStream
  
 
 On Error GoTo EH
Select Case Button
Case vbLeftButton:

 imgInvokeApp.Visible = False
 txtDisplay.Text = "Wait for " & cboDuration.Text
 DoEvents
 Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
  txtDisplay.Text = objSpyCaller.Logkeys(Val(cboDuration.Text))
 imgInvokeApp.Visible = True
 
Case vbRightButton:
  txtDisplay.Text = "Wait for a while"
  DoEvents
  Set objSpyCaller = CreateObject("NetEye.Caller", cboRemoteIP.Text)
  
  Set objText = objFile.OpenTextFile(App.Path & "\WinsKBoard.spy", ForAppending, True)
  objText.Write objSpyCaller.PickKeysFile(strFlag)
  
  txtDisplay.Text = strFlag
 End Select
 
 Exit Sub
EH:
 txtDisplay.Text = Err.Number & Space(1) & Err.Description
 imgInvokeApp.Visible = True
 
End Sub

Private Sub imgShutDown_Click()
 Dim objCaller As Object, intMode As Byte
On Error GoTo EH
 Set objCaller = CreateObject("NetEye.Caller", cboRemoteIP)

 Select Case cboShutDownMode.Text
  Case "Log Off": intMode = 0
  Case "Shut Down": intMode = 1
  Case "Restart": intMode = 2
  Case "Log Off All": intMode = 4
  
  Case "Open CDRom"
    txtDisplay = cboRemoteIP.Text & Space(4) & objCaller.OpenCloseCDRom("set cd door open"): Exit Sub
  Case "Close CDRom"
    txtDisplay = cboRemoteIP.Text & Space(4) & objCaller.OpenCloseCDRom("set cd door closed"): Exit Sub
  
  Case Else
    Exit Sub
 End Select
 
 
 If objCaller.ShutDown(intMode) <> 0 Then
   txtDisplay = cboRemoteIP.Text & "  was Sucessfully " & cboShutDownMode.Text
 Else
   txtDisplay = "Unable to " & cboShutDownMode.Text & " Press F1 for Help!"
 End If
 
 Exit Sub
EH:
 txtDisplay = Err.Number & Space(2) & Err.Description & "  ShutDown"

End Sub

Private Sub imgShutDown_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
 imgShutDown.Picture = ImgList(1).ListImages(9).Picture
 flgIcon = True
End Sub

Private Sub lblDisplay_DblClick()
 txtDisplay.Text = vbNullString
End Sub



Private Sub imgStatus_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
On Error GoTo EH

 Select Case Button
  Case vbLeftButton
    imgStatus.Picture = imgLstSpy.ListImages(1).Picture
  
  Case vbRightButton
    txtDisplay = "Wait for 02 Seconds!..... Connecting to " & cboRemoteIP
    imgStatus.Picture = LoadPicture()
    If CheckConnection = 0 Then
     imgStatus.Picture = imgLstSpy.ListImages(3).Picture
     txtDisplay = cboRemoteIP & " Machine is Off-Line / Not-Existing....."
    Else
     imgStatus.Picture = imgLstSpy.ListImages(2).Picture
     txtDisplay = cboRemoteIP & " is On-Line / Existing....."
    End If
 End Select
 Exit Sub
 
EH:
 txtDisplay = Err.Number & Space(3) & Err.Description & vbCrLf & "Staus Indicator"
 imgStatus.Picture = imgLstSpy.ListImages(1).Picture
End Sub

Private Sub imgTray_Click()
 
End Sub

Private Sub lblCounter_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = vbRightButton Then lngCounter = 0: lblCounter.Caption = vbNullString
End Sub

Private Sub lstSpyData_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
 If Button = vbRightButton Then lstSpyData.Clear
End Sub


Private Sub lstKeys_DblClick()
  txtSendKeys.Text = txtSendKeys.Text & lstKeys.Text
End Sub

Private Function EmptyFile(ByVal FileName As String) As String
  Dim objFile As New FileSystemObject
  Dim objTxtStr As TextStream
  On Error GoTo EH
  Set objTxtStr = objFile.OpenTextFile(App.Path & "\" & FileName, ForWriting)
  objTxtStr.Write vbNullString
  EmptyFile = FileName & " was washed successfully..........."
  Exit Function
EH:
  EmptyFile = FileName & " was alredy delted! Re-Scan to generate it.."
End Function

Private Function CheckConnection() As Integer
 Dim strCommand As String, strDummy As Variant
 Dim objFile As New FileSystemObject
 Dim objTextStream As TextStream
 
 strDummy = Timer
 strCommand = App.Path & "\NetEyePing.bat " & cboRemoteIP.Text
 Shell strCommand, vbHide
 
 Do While CDbl(Timer - strDummy) < 2
  DoEvents
 Loop
 
 Set objTextStream = objFile.OpenTextFile(App.Path & "\NetEyePing.txt", ForReading)
 CheckConnection = InStr(objTextStream.ReadAll, "Reply")
End Function


Private Sub mnuAbout_Click()
 frmAbout.Show
End Sub

Private Sub mnuExit_Click()
 Delete_Tray
 End
End Sub

Private Sub mnuShow_Click()
  Delete_Tray
  Query.Show
End Sub


Private Sub picTray_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
    Dim Msg
    Msg = X / Screen.TwipsPerPixelX
    If Msg = WM_LBUTTONDBLCLK Then  'If the user dubbel-clicked on the icon
        Delete_Tray
        Query.Show
    ElseIf Msg = WM_RBUTTONUP Then  'Right click
        Me.PopupMenu mnuFile
    End If
End Sub



Private Sub tmrCaptureMouse_Timer()
 Dim objCaller As Object
 On Error GoTo EH:
 
 Set objCaller = CreateObject("NetEye.Caller", cboRemoteIP)
 Call GetCursorPos(mousePT)
 txtDisplay = objCaller.CaptureMouse(mousePT.X, mousePT.Y)
 Exit Sub
EH:
 tmrCaptureMouse.Enabled = False
 txtDisplay = Err.Number & Space(2) & Err.Description
End Sub

Private Sub tmrScan_Timer()
Dim objFile As New FileSystemObject
Dim objTextStream As TextStream
Dim strTrip As String
On Error GoTo EH

 strTrip = MakeTrip()
 If strTrip = "Success" Then
    lngCounter = lngCounter + 1
    lblCounter.Caption = lngCounter
    imgStatus.Picture = imgLstSpy.ListImages(2).Picture
    Set objTextStream = objFile.OpenTextFile(App.Path & "\" & "Data.spy", ForReading)
    lstSpyData.Clear
    Do While Not objTextStream.AtEndOfStream
      lstSpyData.AddItem objTextStream.ReadLine, 0
    Loop
   
 Else
    txtDisplay.Text = strTrip
    imgStatus.Picture = imgLstSpy.ListImages(3).Picture
 End If
 
Exit Sub
EH:
  tmrScan.Enabled = False
  txtDisplay.Text = Err.Number & Space(1) & Err.Description & vbCrLf & "Query.tmrScan_Timer()"
  imgStatus.Picture = imgLstSpy.ListImages(3).Picture
  imgScan.ToolTipText = "Start Scanning"
End Sub

Private Sub txtDisplay_DblClick()
  txtDisplay.Text = vbNullString
End Sub

Private Sub txtSendKeys_KeyUp(KeyCode As Integer, Shift As Integer)
 Dim K As String
 On Error GoTo EH
 
 Select Case KeyCode
   Case 13: K = "{ENTER}"
   Case 16: K = "+": txtSendKeys.SetFocus
   Case 17: K = "^": txtSendKeys.SetFocus
   Case 18: K = "%": txtSendKeys.SetFocus
   Case 19: K = "{BREAK}": txtSendKeys.SetFocus
   
   Case 20: K = "{CAPSLOCK}": txtSendKeys.SetFocus
   Case 27: K = "{ESC}"
   Case 37: K = "{LEFT}"
   
   Case 33: K = "{PGUP}"
   Case 34: K = "{PGDN}"
   Case 35: K = "{END}"
   Case 36: K = "{HOME}"
      
   Case 38: K = "{UP}"
   Case 39: K = "{RIGHT}"
   Case 40: K = "{DOWN}"
   Case 44: K = "{PRTSC}"
   Case 45: K = "{INSERT}"
   Case 46: K = "{DELETE}"
   
   
   Case 91: SendKeys "{ESC}", True: txtSendKeys.SetFocus
   
   Case 112: K = "{F1}"
   Case 113: K = "{F2}"
   Case 114: K = "{F3}"
   Case 115: K = "{F4}"
   Case 116: K = "{F5}"
   Case 117: K = "{F6}"
   Case 118: K = "{F7}"
   Case 119: K = "{F8}"
   Case 120: K = "{F9}"
   Case 121: K = "{F10}": txtSendKeys.SetFocus
   Case 122: K = "{F11}"
   Case 123: K = "{F12}"
   
   Case 145: K = "{NUMLOCK}"
   Case 145: K = "{SCROLLLOCK}"
   
 End Select
'  txtDisplay.Text = KeyCode
   txtSendKeys.Text = txtSendKeys.Text & K
   
EH:
   Exit Sub
   txtDisplay = Err.Number & Space(2) & Err.Description
End Sub
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \  lt  \  GIF87a æ  tztdB$¬¶¬4:4¼\"LRL¤jÔÖÔ¦$db\D*||ì¾T:,ÄÆ¼lrl,2,¼|,*$\b\¼¾´DJD\ZTdjdDBD$*$äæä¤®¤LJD
|zttJ´¾´<B<Ü<$"TZT¤¦¤42,|ÌÎÌtrl¬®¤ljdTJL
dJ<´¶´<:<¼dTRT´r$ÜÞÜ¦4dbdÄÆÄ,*,¼¾¼\Z\ìîìLJL|z|$"$424trt¬®¬ljl                                                                                                                  ,      ÿ  ¡¢£¤¥)¨¦«¬­®¯°±=NUQNNGGMHHNKPL¸P¾KÀÅ